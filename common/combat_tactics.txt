#### COMBAT TACTICS ###########################################################
#
# NOTE: tactics must start with "tactic_" in their name to work with techs.
# countered_by = tactic_elastic_defense
# display_phase = tactical_withdrawal 
# phase = close_combat (В trigger проверяет, без - устанавливает)
# only_show_for = SOV
###############################################################################

phases = { # phase = no is the standard phase
	close_combat
	tactical_withdrawal
	seize_bridge
	hold_bridge
}

tactic_basic_attack = {

	is_attacker = yes
	trigger = { # combined scope for both country and combatant
		is_attacker = yes
		phase = no
	}
	
	active = yes

	base =  { factor = 4 }
	picture = attack
	
	countered_by = tactic_counterattack

	attacker = 0.05
}

tactic_basic_defend = {
	is_attacker = no
	trigger = {
		is_attacker = no
		phase = no
	}
	
	active = yes
	
	base =  { factor = 4 }
	picture = defend
	
	defender = 0.05
}

tactic_counterattack = { # counters basic attack, assault
	is_attacker = no
	trigger = {
		is_attacker = no
		skill_advantage > 0
		phase = no
	}
	
	active = yes
	
	base =  {
		factor = 4
		modifier = {
			add = 4
			has_trait = unyielding_defender
		}
	}
	picture = counterattack
	
	defender = 0.25
}


tactic_assault = { 
	is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = no
	}
	
	active = yes
	
	base =  {
		factor = 2
		modifier = {
			add = 2

			has_trait = aggressive_assaulter
		}

		modifier = {
			factor = 0.2

			NOT = { is_fighting_in_terrain = urban }
		}

	} #Revisit ideally this should be more common in urban terrain
	
	picture = assault
	countered_by = tactic_counterattack
	
	phase = close_combat #changes phase to close combat
	
	attacker = 0.25			#attacker gets a bonus to doing damage
}
###close combat tactics here
tactic_cc_attack = { 
	is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = close_combat
	}
	
	active = yes
	
	base =  { factor = 4 }
	picture = cc_attack
	display_phase = close_combat

	attacker = 0.1			#attacker gets a bonus to doing damage
	defender = 0.05
}
tactic_cc_defend = { 
	is_attacker = no
	trigger = {
		is_attacker = no
		phase = close_combat
	}
	
	active = yes
	
	base =  { factor = 4 }
	picture = cc_defend
	display_phase = close_combat

	attacker = 0.05
	defender = 0.1			#defender gets a bonus to doing damage
}
tactic_cc_storm = { 
	is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = close_combat
	}
	
	active = yes
	
	base =  { factor = 2 }
	picture = cc_storm
	display_phase = close_combat

	attacker = 0.2			#attacker gets a bonus to doing damage
	defender = 0.2
}
tactic_cc_local_strong_point = { 
	is_attacker = no
	trigger = {
		is_attacker = no
		phase = close_combat
	}
	
	active = yes
	display_phase = close_combat

	base =  { factor = 2 }
	picture = cc_local_strong_point
	
	attacker = -0.2			#attacker gets a penalty to doing damage
}
tactic_cc_withdraw = { 
	is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = close_combat
	}
	
	active = yes
	
	base =  { factor = 1 }
	picture = cc_withdraw
	display_phase = close_combat

	phase = no #changes phase to no
	
	attacker = -0.05
	defender = -0.05
}


tactic_encirclement = {
	is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = no
		frontage_full = yes
		has_reserves = yes
		OR = {
			skill_advantage > 0
			has_trait = panzer_leader
			has_trait = trickster
		}
	}
	
	active = yes
	
	base =  { 
		factor = 4
		modifier = {
			add = 4
			OR = {
				has_trait = panzer_expert
				has_trait = combined_arms_expert
			}
		}
	}
	
	picture = encircle
	countered_by = tactic_tactical_withdrawal

	combat_width = 0.5		#increased combat_width
	attacker = 0.25
	defender = 0.05
}

tactic_delay = {
	is_attacker = no
	trigger = {
		is_attacker = no
		phase = no
	}
	
	active = no
	
	base =  {
		factor = 4
	}
	picture = delay
	countered_by = tactic_shock
	
	attacker_movement_speed = -0.25		#
	attacker = -0.25
	defender = -0.15
}

tactic_shock = { #counters delay
	is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = no
	}
	
	active = yes
	
	base =  {
		factor = 4
		modifier = {
			add = 4
			has_trait = aggressive_assaulter
		}
	}
	picture = shock
	countered_by = tactic_ambush
	
	defender = -0.25
}

tactic_tactical_withdrawal = { #counters encirclement
	is_attacker = no
	trigger = {
		is_attacker = no
		phase = no
		OR = {
			skill_advantage > 0
			has_trait = trickster
		}
	}
	
	active = no
	
	base =  { factor = 4 }
	picture = withdraw
	
	phase = tactical_withdrawal
	
	combat_width = -0.25
	attacker = -0.25
	defender = -0.05
}
###tactical withdrawal tactics
tactic_tw_attack = { 
	is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = tactical_withdrawal
	}
	
	base =  { factor = 4 }
	picture = tw_attack
	display_phase = tactical_withdrawal
	
	combat_width = -0.25	
	attacker = -0.25
	defender = -0.1
}
tactic_tw_defend = { 
	is_attacker = no
	trigger = {
		is_attacker = no
		phase = tactical_withdrawal
	}
	
	base =  { factor = 4 }
	picture = tw_defend
	display_phase = tactical_withdrawal
	
	combat_width = -0.25		
	attacker = -0.3
	defender = -0.05
}


#НИЖЕ МОДОВЫЕ ТАКТИКИ

tactic_city_defend_bybuild = { #Основа тактики - реальная тактика АЗОВа в Мариуполе. АКА Дом на дом.

is_defender = yes
	trigger = {
		is_defender = yes
		OR = {
        is_fighting_in_terrain = urban
		is_fighting_in_terrain = industrial
		}
		phase = no
	}
	
	active = yes
	
	base =  { factor = 4 }
	picture = tactic_barrage
	
	combat_width = -0.5
	attacker = -0.1
	defender_movement_speed = -0.25
	defender = 0.3	

}

tactic_meath_storm = { #Мясной штурм

is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = no
	}
	
	active = yes
	
	base =  { factor = 4 }
	picture = tactic_barrage
	
	attacker_movement_speed = -0.25
	attacker = 0.2
	defender = -0.1	

}

tactic_city_attacker_bybuild = { #Пуш городов

is_attacker = yes
	trigger = {
		is_attacker = yes
		OR = {
        is_fighting_in_terrain = urban
		is_fighting_in_terrain = industrial
		}
		phase = no
	}
	
	active = yes
	
	base =  { factor = 4 }
	picture = tactic_barrage
	
	combat_width = -0.5
	attacker_movement_speed = -0.2
	attacker = 0.2
	defender = -0.1	

}

tactic_partisan_war_battle = { #Партизанская тактика

is_defender = yes
	trigger = {
		is_defender = yes
		less_combat_width_than_opponent = yes
		phase = no
	}
	
	active = yes
	
	base =  { factor = 4 }
	picture = tactic_barrage
	
	attacker_movement_speed = -0.2
	attacker = -0.1
	defender = -0.05	

}

tactic_russia_taktika_kolonu = { #Тактика колоны (Доступна до ивента про провал ее)
only_show_for = RUS

is_attacker = yes
	trigger = {
		is_attacker = yes
		tag = RUS
		NOT = { has_global_flag = hide_tactic_russia_taktika_kolonu }
		phase = no
	}
	
	active = yes
	
	base =  { factor = 4 }
	picture = tactic_barrage
	countered_by = tactic_partisan_war_battle
	attacker_movement_speed = 0.25
	attacker = -0.05
	defender = 0.05	

}

tactic_dig_offensive = { #Штурм окопа

is_attacker = yes
	trigger = {
		is_attacker = yes
		phase = close_combat
		dig_in > 0.5
	}
	
	active = yes
	
	base =  { factor = 4 }
	display_phase = close_combat
	picture = tactic_barrage
	
	attacker_movement_speed = -0.1
	attacker = -0.1
	defender = -0.1	

}